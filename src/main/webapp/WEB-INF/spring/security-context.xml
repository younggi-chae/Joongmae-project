<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xmlns:security="http://www.springframework.org/schema/security"
   xmlns:context="http://www.springframework.org/schema/context"
   xsi:schemaLocation="http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd
      http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
      http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.3.xsd">

<bean id="bcryptPasswordEncoder" class="org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder" />

<security:http>
      <security:intercept-url pattern="/" access="permitAll"/>
      <security:intercept-url pattern="/user" access="hasRole('ROLE_USER')"/>
      <security:form-login login-page="/member/login"
                      login-processing-url="/member/login" 
                      default-target-url="/main"/>  <!--  로그인 성공후 uri -->
                  
                      
            <!-- <security:csrf disabled="true"/>    --> 
                      
         <!-- 최대 한 개의 세션만 생성되도록 -->
      <security:session-management invalid-session-url="/member/login">
            <security:concurrency-control max-sessions="1"
                                   expired-url="/member/login"
                                   error-if-maximum-exceeded="true" />
        </security:session-management>             
                      
                      
                      
   </security:http>
   
   <security:authentication-manager>   
      <security:authentication-provider>
      
      <security:password-encoder ref="bcryptPasswordEncoder"/>

      
      <security:jdbc-user-service data-source-ref="dataSource"
       users-by-username-query="select username,password,enabled from users where username=?"
      authorities-by-username-query="select username,password,authority from users where username=?"/>
      
         
   
      </security:authentication-provider>
   </security:authentication-manager>

</beans>